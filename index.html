<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Notes Square</title>
<style>
  /* --------- base & theme variables --------- */
  :root{
    --bg:#f7f7f7;
    --text:#111;
    --muted:#666;
    --card:#fff;
    --accent1:#8b5cf6;  /* purple */
    --accent2:#f59e0b;  /* gold */
    --btn-grad: linear-gradient(135deg,#ffb86b,#ff5e62);
    --glass: rgba(255,255,255,0.65);
  }
  body.dark{
    --bg:#0b0b0d;
    --text:#eaeaea;
    --muted:#9b9b9b;
    --card:#0f0f12;
    --accent1:#6a11cb;
    --accent2:#f39c12;
    --btn-grad: linear-gradient(135deg,#ff5e62,#c0392b);
    --glass: rgba(18,18,20,0.5);
  }

  *{box-sizing:border-box;margin:0;padding:0}
  html,body{height:100%}
  body{
    font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial;
    background:var(--bg); color:var(--text); -webkit-font-smoothing:antialiased;
    transition: background .45s ease, color .45s ease;
  }
  main{max-width:1100px;margin:28px auto;padding:0 20px 80px}

  /* header */
  header{
    height:92px; display:flex; align-items:center; justify-content:center; position:relative;
    background: linear-gradient(90deg,var(--accent1),var(--accent2));
    background-size:300% 300%;
    box-shadow: 0 8px 30px rgba(2,6,23,0.12);
    border-radius:12px;
    padding:0 20px; margin:10px 20px;
    color:#fff; font-weight:700; letter-spacing:0.2px;
    transition: background .45s, color .3s, transform .2s;
  }
  /* ensure header contrast in both themes */
  header .title{display:flex;gap:12px;align-items:center;font-size:20px}
  header .sub { font-weight:600; opacity:0.95 }

  /* search */
  .search-wrap { display:flex; justify-content:center; margin-top:18px; }
  #searchBar{
    width:80%; max-width:760px; padding:12px 16px; border-radius:12px; border:1px solid rgba(0,0,0,0.08);
    background: var(--card); color: var(--text); font-size:15px;
    box-shadow: 0 8px 30px rgba(96,64,255,0.03);
  }
  body.dark #searchBar{ background:#0d0d10; color:var(--text); border:1px solid rgba(255,255,255,0.04) }

  /* categories */
  .category-title { font-size:18px; font-weight:700; margin:28px 0 8px 6px; color:var(--text);
    opacity:0; transform:translateX(-18px); transition: all .45s cubic-bezier(.2,.9,.3,1); }
  .category-title.revealed { opacity:1; transform:none }

  /* note cards */
  .notes-list { margin-top:8px; display:block; }
  .note-card{
    background: var(--card);
    padding:16px;border-radius:14px;margin:12px 6px;
    box-shadow: 0 10px 30px rgba(2,6,23,0.08);
    transition: transform .25s ease, box-shadow .25s ease;
    opacity:0; transform: translateY(18px) scale(.995);
  }
  .note-card.revealed{ opacity:1; transform:none }
  .note-card:hover{ transform: translateY(-8px) scale(1.02); box-shadow: 0 22px 48px rgba(2,6,23,0.14) }

  .tilt { perspective:1200px }
  .tilt-inner { transform-style:preserve-3d; transition: transform .12s linear }

  .note-meta{ color:var(--muted); margin-top:8px; font-size:13px }

  /* download btn */
  .download-btn{
    display:inline-block;padding:10px 14px;border-radius:12px;margin-top:10px;
    background:var(--btn-grad); color:#fff; font-weight:800; text-decoration:none;
    box-shadow: 0 8px 24px rgba(0,0,0,0.12); position:relative; overflow:hidden;
    transition: transform .12s ease;
  }
  .download-btn:active{ transform: scale(.98) }
  .ripple{ position:absolute; left:50%; top:50%; width:18px; height:18px; border-radius:50%;
    background: rgba(255,255,255,0.6); transform: translate(-50%,-50%) scale(0); animation: rippleAnim .6s forwards }
  @keyframes rippleAnim { to { transform: translate(-50%,-50%) scale(26); opacity:0 } }
  .download-check{
    position:absolute; inset:0; display:flex; align-items:center; justify-content:center;
    font-size:14px; color:#fff; opacity:0; transition:opacity .18s;
  }

  /* floating decorative shapes */
  .float-wrap{ position:fixed; inset:0; pointer-events:none; z-index:0 }
  .float{ position:absolute; width:110px; height:110px; border-radius:18px;
    background: linear-gradient(135deg, rgba(106,17,203,0.14), rgba(37,117,252,0.14));
    filter: blur(18px); opacity:0.6; animation: floaty 9s ease-in-out infinite }
  .float.l1{ left:6%; top:18% } .float.l2{ right:6%; top:40%; width:160px; height:160px }
  @keyframes floaty { 0%{ transform:translateY(0) } 50%{ transform:translateY(-26px)} 100%{ transform:translateY(0)} }

  /* stagger util */
  .stagger-child{ opacity:0; transform: translateY(12px) scale(.995) }
  .stagger-child.stagger-in{ animation: childIn .45s cubic-bezier(.2,.9,.3,1) forwards; animation-delay: calc(var(--st-index) * .07s) }
  @keyframes childIn { to { opacity:1; transform:none } }

  /* footer */
  footer{ text-align:center; padding:22px 8px; color:var(--muted); font-size:13px; margin-top:28px }

  /* glass toggle (floating) */
  .toggle-wrap{ position:fixed; right:20px; top:18px; z-index:999; display:flex; align-items:center; gap:10px }
  .toggle-btn{
    padding:8px 14px;border-radius:12px; cursor:pointer; font-weight:700;
    background: linear-gradient(135deg, rgba(255,255,255,0.08), rgba(255,255,255,0.02));
    backdrop-filter: blur(8px); border:1px solid rgba(255,255,255,0.06); color:var(--text);
    box-shadow: 0 6px 18px rgba(2,6,23,0.06);
    display:flex; gap:8px; align-items:center;
  }
  body.dark .toggle-btn{ background: linear-gradient(135deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); color:#fff; border:1px solid rgba(255,255,255,0.09) }

  /* responsive */
  @media(max-width:760px){
    header{ margin:8px 10px }
    .float.l1{ display:none }
    .float.l2{ display:none }
  }
</style>
</head>
<body>

<!-- decorative floats -->
<div class="float-wrap" aria-hidden="true">
  <div class="float l1"></div>
  <div class="float l2"></div>
</div>

<header id="siteHeader" class="header-parallax">
  <div class="title"><span style="font-size:20px">üìò</span> <span class="sub">Notes Square</span></div>
</header>

<!-- glass toggle -->
<div class="toggle-wrap">
  <button id="themeToggle" class="toggle-btn">üåô Dark Mode</button>
</div>

<main>
  <div class="search-wrap">
    <input id="searchBar" placeholder="Search notes or categories..." autocomplete="off" />
  </div>

  <div id="contentArea"></div>

  <footer>Made with ‚ù§Ô∏è ‚Äî by MahaLaxmi Aigali</footer>
</main>

<script>
/* ---------------- fetch manifest ---------------- */
async function fetchManifest(){
  try{
    const res = await fetch('notes/manifest.json', {cache: "no-store"});
    if(!res.ok) throw new Error('manifest not found');
    return await res.json();
  }catch(e){ console.error(e); return null }
}

/* ---------------- create card ---------------- */
function createNoteCard(pdf){
  const card = document.createElement('div');
  card.className = 'note-card tilt';
  card.innerHTML = `
    <div class="tilt-inner">
      <div style="font-weight:700;font-size:16px">${pdf.name}</div>
      <div class="note-meta">Size: ${pdf.size || '‚Äî'}</div>
      <a class="download-btn" href="notes/${pdf.file}" download>Download PDF
        <span class="download-check">‚úì</span>
      </a>
    </div>
  `;
  card.dataset.name = pdf.name.toLowerCase();
  card.dataset.category = (pdf._category || '').toLowerCase();
  const btn = card.querySelector('.download-btn');
  btn.classList.add('magnetic');

  btn.addEventListener('click', (e) => {
    const r = document.createElement('span');
    r.className = 'ripple';
    btn.appendChild(r);
    setTimeout(()=> r.remove(), 700);
    const ch = btn.querySelector('.download-check');
    ch.style.opacity = '1';
    setTimeout(()=> ch.style.opacity = '0', 900);
  });
  return card;
}

/* ---------------- render manifest ---------------- */
function renderManifest(manifest){
  const container = document.getElementById('contentArea'); container.innerHTML = '';
  if(!manifest){ container.innerHTML = '<p style="color:var(--muted)">No notes available.</p>'; return; }

  let st = 0;
  for(const [category, arr] of Object.entries(manifest)){
    const cat = document.createElement('div'); cat.className = 'category-title'; cat.textContent = category; container.appendChild(cat);
    const wrap = document.createElement('div'); wrap.className = 'notes-list'; container.appendChild(wrap);
    if(!arr || arr.length === 0){ const em = document.createElement('div'); em.className='empty'; em.textContent='No notes yet.'; wrap.appendChild(em); continue; }
    arr.forEach(pdf => {
      pdf._category = category;
      const card = createNoteCard(pdf);
      card.classList.add('stagger-child');
      card.style.setProperty('--st-index', st);
      wrap.appendChild(card);
      st++;
    });
  }
  setupRevealObservers();
}

/* ---------------- search ---------------- */
function applySearch(){
  const q = (document.getElementById('searchBar').value || '').trim().toLowerCase();
  document.querySelectorAll('.note-card').forEach(c=>{
    const name = c.dataset.name || '', cat = c.dataset.category || '';
    c.style.display = (!q || name.includes(q) || cat.includes(q)) ? '' : 'none';
  });
}

/* ---------------- reveal observer & reveal logic ---------------- */
function setupRevealObservers(){
  const items = document.querySelectorAll('.category-title, .note-card');
  const obs = new IntersectionObserver((entries, o) => {
    entries.forEach(en => {
      if(en.isIntersecting){
        const el = en.target;
        if(el.classList.contains('category-title')) el.classList.add('revealed');
        else if(el.classList.contains('note-card')) {
          const idx = Array.from(document.querySelectorAll('.note-card')).indexOf(el);
          el.style.transition = `transform .55s cubic-bezier(.2,.9,.3,1) ${idx*0.06}s, opacity .55s ${idx*0.06}s`;
          el.classList.add('revealed');
          attachTilt(el);
        }
        o.unobserve(el);
      }
    });
  }, {root:null, rootMargin:'0px 0px -8% 0px', threshold:0.06});
  items.forEach(i=>obs.observe(i));
}

/* ---------------- 3D tilt ---------------- */
function attachTilt(card){
  const inner = card.querySelector('.tilt-inner'); if(!inner) return;
  function onMove(e){
    const r = card.getBoundingClientRect(), cx = r.left + r.width/2, cy = r.top + r.height/2;
    const dx = e.clientX - cx, dy = e.clientY - cy;
    const rx = (dy / r.height) * -6, ry = (dx / r.width) * 8;
    inner.style.transform = `rotateX(${rx}deg) rotateY(${ry}deg) translateZ(8px)`;
  }
  function onLeave(){ inner.style.transform = ''; }
  card.addEventListener('mousemove', onMove);
  card.addEventListener('mouseleave', onLeave);
}

/* ---------------- magnetic buttons (mouse attraction) ---------------- */
document.addEventListener('mousemove', (e)=>{
  const mx = e.clientX, my = e.clientY;
  document.querySelectorAll('.magnetic').forEach(el=>{
    const r = el.getBoundingClientRect();
    const dx = mx - (r.left + r.width/2), dy = my - (r.top + r.height/2);
    const dist = Math.sqrt(dx*dx + dy*dy), max = 160;
    if(dist < max){
      const strength = (1 - (dist/max));
      el.style.transform = `translate(${dx * 0.06 * strength}px, ${dy * 0.04 * strength}px) scale(${1 + 0.03*strength})`;
      el.style.zIndex = 30;
    } else { el.style.transform = ''; el.style.zIndex = ''; }
  });
});
document.addEventListener('mouseleave', ()=> document.querySelectorAll('.magnetic').forEach(el=> el.style.transform=''));

/* ---------------- theme toggle ---------------- */
const themeToggle = document.getElementById('themeToggle');
function applyStoredTheme(){
  if(localStorage.getItem('dark') === 'true'){ document.body.classList.add('dark'); themeToggle.textContent = '‚òÄÔ∏è Light Mode'; }
  else { document.body.classList.remove('dark'); themeToggle.textContent = 'üåô Dark Mode'; }
}
themeToggle.addEventListener('click', ()=>{
  document.body.classList.toggle('dark');
  localStorage.setItem('dark', document.body.classList.contains('dark') ? 'true' : 'false');
  applyStoredTheme();
});
applyStoredTheme();

/* ---------------- init ---------------- */
(async function init(){
  setTimeout(()=> document.querySelector('header').classList.add('enter-header'), 60);
  const manifest = await fetchManifest();
  if(!manifest) { document.getElementById('contentArea').innerHTML = '<p style="color:var(--muted)">Failed to load notes manifest.</p>'; return; }
  renderManifest(manifest);
  document.getElementById('searchBar').addEventListener('input', applySearch);
})();
</script>
</body>
</html>
